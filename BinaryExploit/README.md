# Binary Exploitation

## Libraries
### python3-pwntools 
Great lib used to created framworks for dugging and executing expolits.

https://github.com/arthaud/python3-pwntools

### gdb-peda            
Add-on for GDB that makes the whole process a little easier.

https://github.com/longld/peda

### libc-database
Build a database of libc offsets to simplify exploitation. Can be used to detect versions of `libc` on a remote server. 

e.g. 
```
$ ./find fgets 0x7fdf868efad0 puts 0x7fdf868f1690

ubuntu-xenial-amd64-libc6 (id libc6_2.23-0ubuntu10_amd64)
archive-glibc (id libc6_2.23-0ubuntu11_amd64)
```

Will provide a version of `libc` that has the gap between each of these functions.


https://github.com/niklasb/libc-database


## Payload one-liners

### Python
Note: This will include a newline char (\n) without the `end=''`
```
python -c "print('\x41' * 100, end='')"
```

### Perl
```
perl -e 'print("\x41"x100)'
```

Note: quotation marks are important here. i.e.

```perl -e 'print("\x41"x100)'``` Output: **A**


```perl -e "print('\x41'x100)"``` Output: **\x41**

### Netcat

Hosting a binary to similate a remote setting
```
nc -lp <PORT> --exec <BINARY>
```


## Registers

![](_images/registers.png)

x86_64 Register Calling Convention

```
+---------+------+------+------+------+------+------+
| syscall | arg0 | arg1 | arg2 | arg3 | arg4 | arg5 |
+---------+------+------+------+------+------+------+
|   RAX   | RDI  | RSI  | RDX  | RCX  | R8   | R9   |
+---------+------+------+------+------+------+------+
```


## Useful Commands

Get function names
```
nm binary | grep ' t '
```

Get GOT entries
```
readelf --relocs binary
```

Get PLT entries
```
objdump -M intel -dj .plt binary
```

Get sections of the binary
```
readelf --sections binary
```

Virtual address space layout: `vmmap` in PEDA after starting program, otherwise other modules aren't mapped yet.
